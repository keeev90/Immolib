<%= link_to raw("<i class='fas fa-chevron-left'></i> Retour"), user_path(current_user), class: "return-link ml4 pt1" %>
<div class="container text-center">
  <h1 class="primary mb2">Mon logement</h1>
  <div class="mb2">
    <p>üí° <span class="bolder">Partagez votre lien immolib sur vos annonces en ligne ou vos r√©seaux sociaux</span></p>
    <small> Les candidats n'ont plus qu'√† suivre un parcours simple et rapide&nbsp;!</small>
    <div class="url-container">
      <p class="link"> 
        <a><%= @property.go_visit_url %></a> 
        <i class="far fa-copy">
          <span class="copy-text"> Copier le lien </span>
        </i>
      </p>
    </div>
  </div>
  <%if @property.property_picture.attached?%>
    <div class="pic property-picture">
      <%= image_tag @property.property_picture, alt: 'property picture' %>
      <p class="property-picture--change"> Modifier </p>
      <%= link_to "Supprimer la photo", property_property_picture_path(@property), method: "delete", class: "delete-property-picture pt1"  %>
    </div>
  <%else%>
    <div class="pic property-picture no-picture">
      <p>Ajouter une photo √† mon logement</p>
    </div>
  <%end%>
  <%= render(
    partial: 'layouts/picture_modal',
    locals: {
      url: property_property_pictures_path(@property),
      type: :property_picture
    }
  ) %>
  <div class="property-wrapper__left__infos">
    <h2> <%= @property.title %> </h2>
    <h3 class="mb1"> <%= @property.city %> </h3>
    <p><i class="far fa-arrow-alt-circle-right"></i> Mon  annonce en ligne : </p>
    <% if @property.other_link == "" %>
      <p class="mb1"><small><em>Vous n'avez pas encore indiqu√© de lien vers une annonce en ligne (ex : PaP)</em></small></p>
    <% else %>
      <p class="mb1"> <%= link_to @property.other_link, @property.other_link, target: '_blank' %> </p>
    <% end %>
    <p><i class="far fa-arrow-alt-circle-right"></i> Mes instructions de visite : </p>
    <% if @property.instructions == "" %>
      <p class="mb1"><small><em>‚ö†Ô∏è  Vous n'avez pas encore indiqu√© d'instructions pour vos candidats (adresse, digicode, interphone, etc.) <br/> Ces instructions seront envoy√©es automatiquement aux candidats √† l'approche d'une visite</em></small></p>
    <% else %>
      <p><em><%= simple_format(@property.instructions) %></em></p> 
    <% end %>
    <p><%= link_to "√âditer mon logement", edit_property_path(@property), class:"btn small-btn white-btn bg-primary" %></p>
    <p><%= link_to "Supprimer mon logement", property_path(@property), method: "delete", data: {confirm: "√ätes-vous s√ªr ? Cette action est irr√©versible."}, class:"btn small-btn white-btn bg-warning"%></p>
    <small><em><i class="fas fa-info-circle"></i> En cas de visites pr√©vues elles seront automatiquement annul√©es<br/> Les candidats seront automatiquement pr√©venus par email</em></small>
  </div>
</div>
<div class="container">
  <hr/>
</div>
<div class="container text-center">
  <h1 class="primary mb2">Mes visites</h1>
  <div class="mb2">
    <% if @property.owner_project == "rent" %>
      <p>üí° <span class="bolder">Cliquez sur un cr√©neau √† venir pour acc√©der √† la liste des candidats inscrits et visualiser leurs dossiers de location<span class="bolder"></p>
    <% else %>
      <p>üí° <span class="bolder">Cliquez sur un cr√©neau √† venir pour acc√©der √† la liste des candidats inscrits et visualiser leurs profils<span class="bolder"></p>
    <% end %>
  </div>
  <%= render(partial: 'calendar') %>
  <% if @property.has_available_slot? == false %>
    <p class="mt2"><small><em>‚ö†Ô∏è  Aucun cr√©neau de visite disponible. Vous pourriez passer √† c√¥t√© de nouveaux candidats...</em></small></p>
  <% end %>  
  <%= link_to 'Ajouter un cr√©neau de visite', new_property_slot_path(@property, redirect_path: "existing_property"), class:"btn small-btn white-btn bg-primary" %>
</div>
<div class="container">
  <hr/>
</div>
<div class="container">
  <h1 class="primary mb2 text-center">Mes candidats</h1>
  <% if @property.candidates.size > 0 %>
    <p class="mb2 text-center">üí° <span class="bolder">Cliquez sur un candidat pour voir sa fiche d√©taill√©e</span></p>
    <div class="slot-wrapper pl2 pr2 pb2">
      <div class="slot-wrapper-left">
        <div class="slot-wrapper__content">
          <% firstSlot = true %>
          <% @property.appointments.each do |a| %>
            <%= link_to render(partial: "candidate_list", locals: {a: a, first: firstSlot}), property_candidate_details_path(@property, appointment: a), remote: true %>
            <% firstSlot = false %>
          <% end %>
        </div>
      </div>
      <div class="slot-wrapper-right">
        <%= render(partial: "show_candidate_details", locals: {appointment: @property.appointments.first}) %>
      </div>
    </div>
  <% else %>
    <div class="text-center">
      <p class="mb2"><small><em> Vous n'avez pas encore de candidats pour ce logement</em></small></p>
      <div class="mb2">
        <p>üí° <span class="bolder">Partagez votre lien immolib sur vos annonces en ligne ou vos r√©seaux sociaux</span></p>
        <small> Les candidats n'ont plus qu'√† suivre un parcours simple et rapide&nbsp;!</small>
        <div class="url-container">
          <p class="link"> 
            <a><%= @property.go_visit_url %></a> 
            <i class="far fa-copy">
              <span class="copy-text"> Copier le lien </span>
            </i>
          </p>
        </div>
      </div>
      <p class="mb2"><small><em>‚ö†Ô∏è  V√©rifiez que vous proposez des cr√©neaux de visite pour ce logement</em></small></p>
    </div>
  <% end %>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.8.0/gsap.min.js"></script>
<%= javascript_include_tag 'clipboard' %>