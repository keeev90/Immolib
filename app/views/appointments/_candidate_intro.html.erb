<div class="candidate-section-title">
  <h1 class="primary">Ma candidature</h1>
</div>
<p class="bolder"><%= appointment.property.title%></p>
<p><%= appointment.property.city%></p>
<%if appointment.property.other_link != ""%>
  <p class="mt2"><small>Voir les dÃ©tails de l'annonce : <%= link_to appointment.property.other_link, appointment.property.other_link, target: '_blank' %></small></p>
<%end%>
<div class="card-white">
  <div class="mb2">
    <%if appointment.is_accepted == false %>
      <%if appointment.property.owner_project == "rent" %>
        <div class="text-center">
          <p class ="mb1">âš ï¸ <span class="bolder danger">DÃ©solÃ©, votre candidature n'a pas Ã©tÃ© retenue</span></p>
          <p>Bon courage dans vos recherches !</p>
        </div>
      <%else%>
        <%if appointment.is_interested == true %>
          <div class="text-center">
            <p class="mb1">âš ï¸ <span class="bolder danger">DÃ©solÃ©, votre offre n'a pas Ã©tÃ© acceptÃ©e</span></p>
            <p>Bon courage dans vos recherches !</p>
          </div>
        <%else%>
          <div class="text-center">
            <p class ="mb1">âš ï¸ <span class="bolder danger">DÃ©solÃ©, votre candidature n'a pas Ã©tÃ© retenue</span></p>
            <p>Bon courage dans vos recherches !</p>
          </div>
        <%end%>
      <%end%>
    <%elsif appointment.is_accepted == true %>
      <%if appointment.property.owner_project == "rent" %>
        <div class="text-center">
          <p class="mb1">ğŸ¥³ <span class="bolder green">FÃ©licitations, votre candidature a Ã©tÃ© retenue !</span></p>
          <p>Surveillez vos emails et votre tÃ©lÃ©phone : le propriÃ©taire prendra contact directement avec vous pour la <span class="bolder">signature du contrat de location</span></p>
          <% if !appointment.candidate.phone_number %>
            <p class="mt2">ğŸ’¡ Pour faciliter les Ã©changes, pensez Ã  <%= link_to "renseigner un numÃ©ro de tÃ©lÃ©phone", edit_user_path(appointment.candidate)%></p>
          <%end%>
        </div>
      <%else%>
        <div class="text-center">
          <p class="mb1">ğŸ¥³ <span class="bolder green">FÃ©licitations, votre offre a Ã©tÃ© acceptÃ©e !</span></p>
          <p>Surveillez vos emails et votre tÃ©lÃ©phone : le propriÃ©taire prendra contact directement avec vous pour la <span class="bolder">signature de la promesse de vente</span></p>
          <% if !appointment.candidate.phone_number %>
            <p class="mt2">ğŸ’¡ Pour faciliter les Ã©changes, pensez Ã  <%= link_to "renseigner un numÃ©ro de tÃ©lÃ©phone", edit_user_path(appointment.candidate)%></p>
          <%end%>
        </div>
      <%end%>
    <%else%>
      <%if appointment.is_interested == true %>
        <%if appointment.property.owner_project == "rent"%>
          <p class="text-center"> ğŸ‘ <span class="bolder">Vous avez confirmÃ© votre intÃ©rÃªt pour ce logement</span></p>
          <p><small><em>Votre confirmation a Ã©tÃ© transmise au propriÃ©taire. Il reviendra vers vous dÃ¨s que possible pour donner suite Ã  votre candidature.</em></small></p>
          <p class="mt2"><small>ğŸ’¡ Pour accompagner votre rÃ©ponse de quelques prÃ©cisions, pensez Ã  <%= link_to "modifier votre message au propriÃ©taire", edit_appointment_candidate_message_path(appointment) %> : vos motivations, les atouts de votre candidature...</small></p>
          <% if !appointment.candidate.phone_number %>
            <p class="mt2"><small>ğŸ’¡ Pour faciliter les Ã©changes, pensez Ã  <%= link_to "renseigner un numÃ©ro de tÃ©lÃ©phone", edit_user_path(appointment.candidate)%></small></p>
          <%end%>
          <% if appointment.candidate_dossierfacile_folder.attached? || appointment.candidate_dossierfacile_link && appointment.candidate_dossierfacile_link != "" %>
            <p class="green mt2"><small>âœ”ï¸ Votre dossier de location est complet</small></p>
          <% elsif appointment.candidate_documents.attached? && appointment.candidate_documents.size == 5 %>
            <p class="green mt2"><small>âœ”ï¸ Votre dossier de location est complet</small></p>
          <%else%>
            <p class="danger mt2"><small>âš ï¸ Votre dossier de location est incomplet: <%= link_to "voir mon dossier", "#candidate-section-3" %></small></p>
          <%end%>
        <%else%>
          <p class="text-center">ğŸ‘ <span class="bolder">Vous avez fait une offre d'achat pour ce logement</span></p>
          <p><small><em>Votre offre a Ã©tÃ© transmise au propriÃ©taire. Il reviendra vers vous dÃ¨s que possible pour donner suite Ã  votre proposition.</em></small></p>
          <p><small><i class="fas fa-info-circle"></i> Contrairement Ã  la signature d'un compromis de vente, votre offre d'achat ne vous engage pas : vous pouvez vous retracter Ã  tout moment.</small></p>
          <p class="mt2"><small>âš ï¸ Pour accompagner votre rÃ©ponse de prÃ©cisions, pensez Ã  <%= link_to "modifier votre message au propriÃ©taire", edit_appointment_candidate_message_path(appointment) %> : rappel de votre identitÃ© complÃ¨te, date et durÃ©e de validitÃ© de l'offre, moyen(s) de financement utilisÃ©(s), justifications en cas de nÃ©gociation du prix...</small></p>
          <% if !appointment.candidate.phone_number %>
            <p class="mt2"><small>ğŸ’¡ Pour faciliter les Ã©changes, pensez Ã  <%= link_to "renseigner un numÃ©ro de tÃ©lÃ©phone", edit_user_path(appointment.candidate)%></small></p>
          <%end%>
        <%end%>
      <%elsif appointment.is_interested == false %>
        <p class="text-center">ğŸ‘ <span class="bolder">Vous avez indiquÃ© ne pas Ãªtre intÃ©ressÃ©(e) par ce logement</span></p>
        <p><small><em>Merci pour votre retour, votre dÃ©cision a Ã©tÃ© transmise au propriÃ©taire.</em></small></p>
      <%else%>
        <%if appointment.slot_id != nil %>
          <%if appointment.slot.is_past? %>
            <%if appointment.property.owner_project == "rent"%>
              <p class="text-center bolder">Souhaitez-vous louer ce logement ?</p>
              <p class="mb1"><small><em>Votre rÃ©ponse sera automatiquement transmise au propriÃ©taire</em></small></p>
            <%else%>
              <p class="text-center bolder">Souhaitez-vous faire une offre d'achat pour ce logement ?</p>
              <p class="mb1"><small><em>Votre offre sera automatiquement transmise au propriÃ©taire</em></small></p>
            <%end%>
            <div class='decision-wrapper'>
              <p>Oui</p>
              <div class='yes-no-toggle'>
                <button class='yes-btn'></button>
                <button class='no-btn'></button>
                <div></div>
              </div>
              <p>Non</p>
            </div>
            <%= form_with model: appointment, url: appointment_candidate_decision_path(appointment), method: "patch", local: true, class: "form", id: "item-form", multipart: true do |f| %>
              <%= f.hidden_field :is_interested %>
              <div>
                <%= f.submit "Valider", class: "btn white-btn bg-primary" %>
              </div>
            <%end%>
            <%= javascript_include_tag 'candidate-yes-no-toggle' %>
          <%else%>
            <p><i class="fas fa-info"></i> <span class="bolder">Vous pourrez confirmer ou non votre intÃ©rÃªt pour ce logement Ã  l'issue de votre visite prÃ©vue le <%= appointment.slot.start_date.strftime("%d/%m") %></span></p>
          <%end%>
        <%else%>
          <p><i class="fas fa-info"></i> <span class="bolder">Aucune visite programmÃ©e</p>
          <p>Vous pourrez confirmer ou non votre intÃ©rÃªt pour ce logement Ã  l'issue d'une visite</p>
        <%end%>
      <%end%>
    <%end%>
  </div>
  <hr class="hr-grey mw80 mb2">
  <%= link_to "Mes visites", "#candidate-section-1", class: "btn outline-btn-white" %>
  <%= link_to "Mon message", "#candidate-section-2", class: "btn outline-btn-white" %>
  <%if appointment.property.owner_project == "rent"%>
    <%= link_to "Mon dossier", "#candidate-section-3", class: "btn outline-btn-white" %>
  <%end%>
</div>
<p class="text-center"><%= link_to "Supprimer ma candidature", appointment_path(@appointment), method: "delete", data: {confirm: "ÃŠtes-vous sÃ»r de supprimer cette candidature ? Cette action est irrÃ©versible."}, class:"btn white-btn bg-warning small-btn" %></p>
<%if appointment.property.owner_project == "rent"%>
  <p><small><em><i class="fas fa-info-circle"></i> Les documents de votre dossier seront automatiquement supprimÃ©s
  <%if ( appointment.slot_id != nil ) && ( appointment.slot.start_date > DateTime.now ) %>
    <br/>Votre visite prÃ©vue le <%= appointment.slot.start_date.strftime("%d/%m") %> sera automatiquement annulÃ©e
  <%end%>
  </em></small></p>
<%else%>
  <p><small><em><i class="fas fa-info-circle"></i> Votre rendez-vous sera automatiquement annulÃ© en cas de visite Ã  venir</em></small></p>
<%end%>