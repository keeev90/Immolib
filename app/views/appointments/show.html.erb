<%= link_to raw("<i class='fas fa-chevron-left'></i> Retour"), user_path(current_user), class: "return-link ml4 pt1" %>
<div class="container-small text-center">
  <%= render partial:"candidate_intro", locals: {appointment: @appointment} %>
  </div>
</div>
<div class="container">
  <hr/>
</div>
<div class="container-small text-center" id='candidate-section-1'>
  <h1 class="bolder primary mb2">Mes visites</h1>
  <div class="mb1">
    <%if @appointment.slot_id != nil %>
      <%if @appointment.slot.start_date > DateTime.now %>
        <div class="card-white">
          <p class="bolder mb1">Prochaine visite pr√©vue le <%= @appointment.slot.start_date.strftime("%d/%m") %> √† <%= @appointment.slot.start_date.strftime("%H:%M") %></p>
          <%if @appointment.property.instructions && @appointment.property.instructions != "" && ( @appointment.slot.start_date.strftime("%d%m%Y") == (DateTime.now + 1).strftime("%d%m%Y") || @appointment.slot.start_date.strftime("%d%m%Y") == DateTime.now.strftime("%d%m%Y") ) %>
            <p class="mb1">Voici les pr√©cisions du propri√©taire pour votre visite :</p>
            <div class="link">
              <p><em><%= simple_format(@appointment.property.instructions) %></em></p>
            </div>
            <%if @appointment.property.owner.phone_number %>
              <p class="mb1">‚ö†Ô∏è En cas de probl√®me, contactez le propri√©taire au <span class="primary"><%= @appointment.property.owner.phone_number %></span></p>
            <%end%>
          <%else%>
            <p><small><em><i class="fas fa-info-circle"></i> Vous recevrez les modalit√©s logistiques (adresse, digicode, interphone, etc.) √† l'approche de la visite</em></small></p> 
          <%end%>
          <% if @appointment.candidate.phone_number %>
            <p class="mt2">üí° Pour faciliter les √©changes avec le propri√©taire, pensez √† <%= link_to "renseigner un num√©ro de t√©l√©phone", edit_user_path(@appointment.candidate)%></p>
          <%end%>
        </div>
        <p class="text-center mt2"><%= link_to "Annuler mon RDV", appointment_candidate_slot_path(@appointment, @appointment.slot), method: "delete", data: {confirm: "√ätes-vous s√ªr d'annuler ce RDV ?"}, class:"btn white-btn bg-warning small-btn" %></p>
        <p class="mt2">üí° Pour d√©placer votre rendez-vous cliquez directement sur un autre cr√©neau disponible</p>
        <%if !@appointment.property.has_available_slot?%>
          <p class="mt2 danger">‚ö†Ô∏è Aucun autre cr√©neau de visite disponible actuellement</p>
        <%end%>
      <%else %>
        <div class="card-white">
          <p class="bolder">Derni√®re visite r√©alis√©e le <%= @appointment.slot.start_date.strftime("%d/%m") %> </p>
        </div>
        <p class="mt1">üí° Pour prendre un nouveau rendez-vous cliquez directement sur un cr√©neau disponible</p>
        <%if !@appointment.property.has_available_slot?%>
          <p class="mt2 danger">‚ö†Ô∏è Aucun cr√©neau de visite disponible actuellement</p>
        <%end%>
      <%end%>
    <%else%>
      <%if @appointment.is_accepted == false %>
        <div class="card-white">
          <p class="bolder mb1">Votre candidature n'ayant pas √©t√© retenue, votre RDV a √©t√© automatiquement annul√©.</p>
          <p>Bon courage dans vos recherches !</p>
        </div>
      <%else%>
        <div class="card-white">
          <p class="bolder">Aucune visite programm√©e</p>
        </div>
        <p class="mt1">üí° Pour prendre rendez-vous cliquez directement sur un cr√©neau disponible</p>
        <%if !@appointment.property.has_available_slot?%>
          <p class="mt2 danger">‚ö†Ô∏è Aucun cr√©neau de visite disponible actuellement</p>
        <%end%>
      <%end%>
    <%end%>
  </div>
  <%unless @appointment.is_accepted == false %>
    <%= render partial:"candidate_calendar", locals: {property: @appointment.property, slots: @slots, date_arr: @date_arr} %>
  <%end%>
</div>
<div class="container">
  <hr/>
</div>
<div class="container-small text-center" id='candidate-section-2'>
  <h1 class="bolder primary mb2">Mon message</h1>
  <%= render partial:"candidate_message", locals: {appointment: @appointment} %>
</div>
<%if @appointment.property.owner_project == "rent"%>
  <div class="container">
    <hr/>
  </div>
  <div class="container-small" id='candidate-section-3'>
    <h1 class="bolder primary text-center mb2">Mon dossier de location</h1>
    <%= render partial:"candidate_folder", locals: {appointment: @appointment} %>
  </div>
<%end%>